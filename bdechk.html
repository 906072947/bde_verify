<html>
  <head>
    <title>bdechk</title>
  </head>
  <body>
    <h1>bdechk</h1>

<h2>Overview</h2>

bdechk is a static analyser for C and C++ code. It is intended to
locate potential coding problems, questionable code, and violations of
coding guidelines. The actual checking is implemented by a
[clang](http://clang.llvm.org) plug-in. Thus, bdechk can only run on
platforms supported by clang which is currently only Linux. The
implementation of bdechk is in its early stages and any feedback sent
to Dietmar Kuhl is welcome.

<h2>Running bdechk</h2>

bdchk behaves like a C or C++ compiler and understands many of the
corresponding options. The command-line invokation of bdechk is meant
to understand the same options as gcc/g++ on Linux machines and it
should be possible to run the checks by replacing the compiler with
bdechk. From the command-line bdechk can be used like this:

<pre>
    ~dkuhl/bdechk [options] &lt;source-files&gt;
</pre>

This call produces warnings (and potentially compile-time errors) to
the standard error stream. The messages include both clang built-in
warnings and errors as well as warnings added by bdechk. The warnings
added by bdechk are prefixed by the string <code>[bdechk]</code>. All
bdechk specific warnings can be switch on or off individually (see
below).  bdechk is already configured to search for header files in
Bloomberg specific directories as well as in standard and system
directorires.

To use bdechk with plink, you can set the CPP make variable when using
plink. This would look like this:

<pre>
    plink project.mk clean
    plink project.mk CPP=~dkuhl/bdechk
</pre>

This second call will "build" all source files which are currently not
up to date. Files with up to date object files would not be build.
Thus, the use of the <code>clean</code> target is needed to make sure
all files need rebuilding. Note, that bdechk won't create any object
files. Hopefully, bdechk will get some support from the build tools to
avoid the <code>clean</code> step (e.g., a target <code>bdechk</code>
could be added to run bdechk on all source files).

<h2>Configuration</h2>

bdechk reads a configuration file used to configure some fundamental
options and what checks to do. The analyser itself turns on all checks
but all checks can be turned on or off individually from a
configuration files. Each line in the configuration file is taken as
individual command to be executed. Empty lines or lines starting with a
<code>#</code> character are ignored. The following commands are
understood:

<ul>
  <li>
    <code>namespace &lt;name&gt;</code>: sets the toplevel namespace to
    be used. When the namespace isn't changed, the toplevel namespace
    defaults to <code>BloombergLP</code>.
  </li>
  <li>
    <code>load &lt;file&gt;</code>: loads the specified file as
    configuration file. If a configuration doesn't exist, it is
    silently ignored. This way, the first configuration file can be
    used to load configuration files in additional locations.
  </li>
  <li>
    <code>group &lt;name&gt; &lt;check&gt;*</code> defines a group of
    checks. <code>name</code> is treated as if it is a check name for
    the purpose of definiting groups and turning checks on or off. The
    list of <code>check</code>s will be turned on or off with when
    corresponding <code>check</code> command is used.
  </li>
  <li>
    <code>check &lt;name&gt; (on|off)</code> turns the named check
    <code>name</code> on or off. If <code>name</code> refers to a group
    of checks, all checks in the group are turned on or off. The last
    <code>check</code> command affecting a specific check determines if
    the check is used. Initially, all checks are turned on but the
    default configuration file turns a few checks off by default.
  </li>
</ul>

An exmaple configuration file could look like this:

<pre>
# First off, make sure the toplevel namespace is suitable:
namespace BloombergLP

# turn off a few special purpose checks:
check constant-return off
check contiguous-switch off

# a group of checks Dietmar likes but are not part of the coding guidelines:
group dk-checks c-cast boolcomparison
# ... and make sure they are turned on:
check dk-checks on

# load a few other configuration files to refine the current settings:
# load a configuration file from the users home directory:
load $HOME/.coolyser
# load a configuration file from the current working directory:
load .coolyser
</pre>

When using an unknown name for a check bdechk will write a list of all
available checks to the standard error stream. This list is readily
formatted to be put into a configuration files and assumes all checks
are to be turned on. Checks not mentioned at all in any configuration
file will be turned on. This way, new checks can be added without the
need to turn them on explicitly. On the other hand this probably means
that new warnings keep popping up occassionally.

<h2>Feedback</h2>

bdechk tries to be helpful. However, it is a project in progress. In
particular, some of the checks may be too harsh and need to be refined
to warn only about problematic situations. On the other hand, certain
problems aren't detected, yet, at all. Also, occassionally the program
fails entirely. Please let Dietmar Kuhl know about any problems you
encountered, about ideas what else to check for, incomplete
documentation, etc.

There is currently no ticketing system set up for bdechk within
Bloomberg. Hopefully this will change once it has proven to be useful.
For the time being bdechk is a spare time project maintained using a
private repository at [github](http://github.com). If you are
interested to be subscribed to see the progress, add issues directly,
or to get involved, please send your github ID to Dietmar Kuhl.

  </body>
</html>
